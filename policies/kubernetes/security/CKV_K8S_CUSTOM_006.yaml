metadata:
  id: "CKV_K8S_CUSTOM_006"
  name: "Ensure pod securityContext is defined with runAsUser > 10000"
  category: "KUBERNETES_SECURITY"
  severity: "MEDIUM"
  guideline: "Running containers with high UID numbers reduces the risk of conflicts with host users and improves security."
definition:
  and:
    - cond_type: "attribute"
      resource_types:
        - "Pod"
        - "Deployment"
        - "StatefulSet"
        - "DaemonSet"
        - "Job"
        - "CronJob"
        - "ReplicaSet"
      attribute: "spec.securityContext.runAsUser"
      operator: "exists"
    - cond_type: "attribute"
      resource_types:
        - "Pod"
        - "Deployment"
        - "StatefulSet"
        - "DaemonSet"
        - "Job"
        - "CronJob"
        - "ReplicaSet"
      attribute: "spec.securityContext.runAsUser"
      operator: "greater_than"
      value: 10000