---
metadata:
  id: "CKV_K8S_CUSTOM_025"
  name: "Ensure deployment has appropriate replica count"
  category: "KUBERNETES_CONFIGURATION"
  severity: "LOW"
  guideline: "Running at least 2 replicas ensures high availability and reduces single point of failure."
definition:
  cond_type: "attribute"
  resource_types:
    - "Deployment"
    - "StatefulSet"
    - "ReplicaSet"
  attribute: "spec.replicas"
  operator: "greater_than_or_equal"
  value: 2

---
metadata:
  id: "CKV_K8S_CUSTOM_026"
  name: "Ensure PodDisruptionBudget is defined for highly available applications"
  category: "KUBERNETES_CONFIGURATION"
  severity: "LOW"
  guideline: "PodDisruptionBudgets ensure minimum availability during voluntary disruptions like node drains."
definition:
  cond_type: "attribute"
  resource_types:
    - "PodDisruptionBudget"
  attribute: "spec"
  operator: "exists"

---
metadata:
  id: "CKV_K8S_CUSTOM_027"
  name: "Ensure pod anti-affinity is set for high availability"
  category: "KUBERNETES_CONFIGURATION"
  severity: "LOW"
  guideline: "Pod anti-affinity spreads replicas across nodes, improving resilience to node failures."
definition:
  cond_type: "attribute"
  resource_types:
    - "Deployment"
    - "StatefulSet"
  attribute: "spec.template.spec.affinity.podAntiAffinity"
  operator: "exists"

---
metadata:
  id: "CKV_K8S_CUSTOM_028"
  name: "Ensure deployment strategy is properly configured"
  category: "KUBERNETES_CONFIGURATION"
  severity: "LOW"
  guideline: "Proper deployment strategy (RollingUpdate) ensures zero-downtime deployments."
definition:
  cond_type: "attribute"
  resource_types:
    - "Deployment"
  attribute: "spec.strategy.type"
  operator: "equals"
  value: "RollingUpdate"

---
metadata:
  id: "CKV_K8S_CUSTOM_029"
  name: "Ensure labels are defined for resources"
  category: "KUBERNETES_CONFIGURATION"
  severity: "LOW"
  guideline: "Labels are essential for resource organization, monitoring, and troubleshooting."
definition:
  cond_type: "attribute"
  resource_types:
    - "Pod"
    - "Deployment"
    - "StatefulSet"
    - "DaemonSet"
    - "Service"
    - "ConfigMap"
    - "Secret"
  attribute: "metadata.labels"
  operator: "exists"

---
metadata:
  id: "CKV_K8S_CUSTOM_030"
  name: "Ensure app label is defined"
  category: "KUBERNETES_CONFIGURATION"
  severity: "LOW"
  guideline: "The 'app' label is a common convention for identifying applications in Kubernetes."
definition:
  cond_type: "attribute"
  resource_types:
    - "Pod"
    - "Deployment"
    - "StatefulSet"
    - "DaemonSet"
    - "Service"
  attribute: "metadata.labels.app"
  operator: "exists"
