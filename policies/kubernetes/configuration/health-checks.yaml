---
metadata:
  id: "CKV_K8S_CUSTOM_013"
  name: "Ensure container has liveness probe defined"
  category: "KUBERNETES_CONFIGURATION"
  severity: "MEDIUM"
  guideline: "Liveness probes help Kubernetes detect when containers are unhealthy and need to be restarted."
definition:
  cond_type: "attribute"
  resource_types:
    - "Pod"
    - "Deployment"
    - "StatefulSet"
    - "DaemonSet"
  attribute: "spec.containers[*].livenessProbe"
  operator: "exists"

---
metadata:
  id: "CKV_K8S_CUSTOM_014"
  name: "Ensure container has readiness probe defined"
  category: "KUBERNETES_CONFIGURATION"
  severity: "MEDIUM"
  guideline: "Readiness probes ensure that traffic is only sent to containers that are ready to handle requests."
definition:
  cond_type: "attribute"
  resource_types:
    - "Pod"
    - "Deployment"
    - "StatefulSet"
    - "DaemonSet"
  attribute: "spec.containers[*].readinessProbe"
  operator: "exists"

---
metadata:
  id: "CKV_K8S_CUSTOM_015"
  name: "Ensure startup probe is defined for slow-starting containers"
  category: "KUBERNETES_CONFIGURATION"
  severity: "LOW"
  guideline: "Startup probes protect slow-starting containers from being killed by liveness probes during initialization."
definition:
  cond_type: "attribute"
  resource_types:
    - "Pod"
    - "Deployment"
    - "StatefulSet"
    - "DaemonSet"
  attribute: "spec.containers[*].startupProbe"
  operator: "exists"
