metadata:
  id: "CKV_K8S_CUSTOM_020"
  name: "Ensure NetworkPolicy has both ingress and egress rules defined"
  category: "KUBERNETES_NETWORKING"
  severity: "MEDIUM"
  guideline: "Defining both ingress and egress rules provides comprehensive network security control."
definition:
  and:
    - cond_type: "attribute"
      resource_types:
        - "NetworkPolicy"
      attribute: "spec.ingress"
      operator: "exists"
    - cond_type: "attribute"
      resource_types:
        - "NetworkPolicy"
      attribute: "spec.egress"
      operator: "exists"