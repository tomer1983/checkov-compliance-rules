metadata:
  id: "CKV_K8S_CUSTOM_022"
  name: "Ensure hostPID is not enabled"
  category: "KUBERNETES_NETWORKING"
  severity: "HIGH"
  guideline: "Enabling hostPID allows the pod to see all processes on the host, which is a security risk."
definition:
  or:
    - cond_type: "attribute"
      resource_types:
        - "Pod"
        - "Deployment"
        - "StatefulSet"
        - "DaemonSet"
        - "Job"
        - "CronJob"
      attribute: "spec.hostPID"
      operator: "not_exists"
    - cond_type: "attribute"
      resource_types:
        - "Pod"
        - "Deployment"
        - "StatefulSet"
        - "DaemonSet"
        - "Job"
        - "CronJob"
      attribute: "spec.hostPID"
      operator: "equals"
      value: false